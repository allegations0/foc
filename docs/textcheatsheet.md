# Content Creator Cheat Sheet

Click on the title for an example.

## General tips

<details>
<summary markdown="span">SAVE THE GAME OFTEN</summary>

You can save your progress by saving your game, the same way you save your game
in a normal playthrough.

</details>

<details>
<summary markdown="span">Use the Content Creator Editor toolbar</summary>

Many of the commands and instructions below can be generated by clicking the menus in the Code Editor toolbar.
</details>

<details>
<summary markdown="span">If your quest has similar outcomes on critical and success, you can avoid duplicating them</summary>

For example, you can first fill in the success outcomes. Then, for critical,
you add the `Outcomes from other quest results...` - `Do all SUCCESS outcomes`.

</details>

<details>
<summary markdown="span">Articles are automatically fixed to be the proper form</summary>

The game will automatically correct articles.
For example, if you write `I eat a apple`, the game will parse it into `I eat an apple`.
This also works for macros, e.g, `Bob is a <<uadj $g.bob>> slaver` can become either
`Bob is a smug slaver` or `Bob is an arrogant slaver`.

</details>

## Logic

<details>
<summary markdown="span">How to generate a slave / slaver with certain traits / titles / etc</summary>

Use the `(Add new NPC)` link to create a new NPC. In that menu,
you find the unit group to based it from, and then click `(New based on this)`.
For example, to create a valefolk with the `brave` trait, I would go to
`Common races...` then `Human (vale)...` then `(New based on this)` on the `All gender` one.
Once there,
inside `Unit effect`, click `(Add new cost)` and add the traits here.

In particular, to replace background, use `Trait...` then `Replace background`.

</details>

## Actor-based conditionals

<details>
<summary markdown="span">Different pronoun / verb / object depending on the unit's gender</summary>

Check [here](docs/text.md) for more details.

```
<<Rep $g.merc1>> merc1|is <<uadj $g.merc1>>, and <<therace $g.merc1>> merc1|love to do nothing more than <<uhobbyverb $g.merc1>>.
```

For example, it can become:

"Bob is brave, and the neko loves to do nothing more than lazying all day long."

or

"You are diligent, and you love to do nothing more than studying in the library."

</details>

<details>
<summary markdown="span">Based on the quest outcome</summary>

```
<<if $gOutcome == 'crit'>>
  A critical success!
<<elseif $gOutcome == 'success'>>
  A success.
<<elseif $gOutcome == 'failure'>>
  A failure...
<<elseif $gOutcome == 'disaster'>>
  A disaster!!!
<</if>>
```

</details>

<details>
<summary markdown="span">Based on whether unit has a certain trait</summary>

Only one of the sentences will appear:

```
<<if $g.merc1.isHasTrait('muscle_strong')>>
  Merc1 is strong.
<<elseif $g.merc1.isHasTrait('tough_tough')>>
  Merc1 is tough.
<<elseif $g.merc1.isHasTrait('face_attractive')>>
  Merc1 is attractive.
<<else>>
  Merc1 is average.
<</if>>
```

Multiple sentences can appear:

```
Merc1 is
<<if $g.merc1.isHasTrait('muscle_strong')>>
  strong,
<</if>>
<<if $g.merc1.isHasTrait('tough_tough')>>
  tough,
<</if>>
<<if $g.merc1.isHasTrait('face_attractive')>>
  attractive,
<</if>>
lewd, but most importantly loyal to your cause.
```

</details>

<details>
<summary markdown="span">Based on unit's gender</summary>

```
<<if $g.merc1.isHasDick()>>
  Merc1 is a man.
<<else>>
  Merc1 is a woman.
<</if>>
```

</details>

<details>
<summary markdown="span">Based on if one of the units going on the quest has a certain trait</summary>

```
<<set _unit = setup.selectUnit([$g.negotiator, $g.merc1, $g.merc2], {trait: 'magic_fire'})>>
<<if _unit>>
  <<Rep _unit>> used <<their _unit>> fire magic to burn the enemies.
<<else>>
  Nobody in the team has access to fire magic.
<</if>>

<<set _unit = setup.selectUnit([$g.negotiator, $g.merc1, $g.merc2], {trait: 'magic_water'})>>
<<if _unit>>
  <<Rep _unit>> meanwhile used <<their _unit>> water magic to flood the battlefield.
<</if>>
```

</details>


## Formatting


<details>
<summary markdown="span">Speech bubble</summary>

```
<<dialogue $g.a>>
Tea or coffee?
<</dialogue>>
```

The dialogue macro supports having [content image](docs/images.md) to override the unit's image.

```
<<dialogue $g.a "some_content_image.jpg">>
Tea or coffee with custom image?
<</dialogue>>
```

</details>

## NPC

<details>
<summary markdown="span">Get a third party slaver to give a minor comment on a situation</summary>

```
<<set _u = setup.getAnySlaver()>>

<<Yourrep _u>> thinks this is not a good idea at all.
But you have other plans.
```

</details>

<details>
<summary markdown="span">Make an NPC has a certain trait / background</summary>

First, click `(Add new NPC)`, then either `(Create new from scratch)` or `(New based on this)`.
In the unit group menu, apply the traits inside the `Unit effect` card.
</details>

## Misc

<details>
<summary markdown="span">Checking if the player is banning certain content like furry, watersports, etc</summary>

List of tags are [here](src/scripts/classes/quest/questtags.js)

```
<<if $settings.bannedtags.watersport>>
  No watersport
<<else>>
  Yes watersport
<</if>>
```

</details>

<details>
<summary markdown="span">Checking if the fort has a certain improvement</summary>

```
<<if $fort.player.isHasBuilding('veteranhall')>>
The veteran hall stood proudly over your fort.
<</if>>
```

See the in-game Database for the list of all buildings/improvements as well as their keys
(the `veteranhall` above is the key of the Veteran Hall building).

</details>

## Advanced

<details>
<summary markdown="span">Giving a reward inside the text</summary>

```
<<if $g.a.isHasTrait('per_brave')>>
  <<Rep $g.a>> foolishly charged headlong into the fray, injuring <<therace $g.a>>.
  <<run setup.qc.Injury('a', 1).apply($gQuest)>>
<</if>>
```

To get the `setup.qc.Injury('a', 1)` part, the easiest is to find the corresponding
effect, put it in the quest outcome, then preview your quest file.
There, find the corresponding `setup.qc.XXX` and copy it.
Finally, go back to the editor and paste the result, and append
`.apply($gQuest)` to it.
Other common example includes:

- Traumatize a for 5 weeks: `<<run setup.qc.TraumatizeRandom('a', 5).apply($gQuest)>>`
- Boonize a for 5 weeks: `<<run setup.qc.BoonizeRandom('a', 5).apply($gQuest)>>`
- Corrupt a: `<<run setup.qc.Corrupt('a').apply($gQuest)>>`
- Bless a: `<<run setup.qc.Blessing('a', 1).apply($gQuest)>>`
- Curse a: `<<run setup.qc.Blessing('a', 1, null, true).apply($gQuest)>>`
- Gain money: `<<run setup.qc.Money(1000).apply($gQuest)>>`
- Lose money: `<<run setup.qc.Money(-1000).apply($gQuest)>>`
- Gain 5.7 friendship: `<<run setup.qc.Friendship('slaver', 'enemy', 57).apply($gQuest)>>`
- Loses 10.3 rivalry: `<<run setup.qc.Friendship('slaver', 'enemy', -103).apply($gQuest)>>`
- Gain 3.1 friendship with you: `<<run setup.qc.FriendshipWithYou('slaver', 31).apply($gQuest)>>`
- Gain 4.4 rivalry with you: `<<run setup.qc.FriendshipWithYou('slaver', -44).apply($gQuest)>>`
- Gain 6.0 favor with werewolf: `<<run setup.qc.Favor('werewolf', 60).apply($gQuest)>>`
- Gain 4 ire with werewolf: `<<run setup.qc.Ire('werewolf', 4).apply($gQuest)>>`

</details>

<details>
<summary markdown="span">Inline Effect for losing unit inside text</summary>

This differs depending on how you want the unit to disappear.

# Unit disappears, but can be rescued with a Rescuer:

```
<<run setup.qc.MissingUnit('abc').apply($gQuest)>>
```

# Unit disappears FOREVER, use with caution!

```
<<run setup.qc.MissingUnitForever('abc').apply($gQuest)>>
```

# Unit disappears, but can be IMMEDIATELY rescued:

For a SLAVER `$g.abc`, you do one of these depending on easy/medium/hard:

```
<<run setup.qc.MissingUnitRecapture('abc', 'capturedeasy').apply($gQuest)>>
<<run setup.qc.MissingUnitRecapture('abc', 'capturedmedium').apply($gQuest)>>
<<run setup.qc.MissingUnitRecapture('abc', 'capturedhard').apply($gQuest)>>
```

For a SLAVE `$g.abc` it's slightly different:

```
<<run setup.qc.MissingUnitRecapture('abc', 'escapeeasy').apply($gQuest)>>
<<run setup.qc.MissingUnitRecapture('abc', 'escapemedium').apply($gQuest)>>
<<run setup.qc.MissingUnitRecapture('abc', 'escapehard').apply($gQuest)>>
```

</details>

## Not in Toolbar

<details>
<summary markdown="span">Strip out of shirt/pants if the unit is wearing one</summary>

To strip out of shirt, if any, use:

```
<<set _eq = $g.a.getChestCovering()>>
<<if _eq>>
  <<Rep $g.a>> <<ustripverb $g.a _eq>> <<their $g.a>> <<rep _eq>> revealing
<<else>>
  Nothing is covering
<</if>>
<<their $g.a>> <<ubreasts $g.a>>.
```

To strip ouf ot pants, if any, use:

```
<<set _eq = $g.a.getGenitalCovering()>>
<<if _eq>>
  <<Rep $g.a>> <<ustripverb $g.a _eq>> <<their $g.a>> <<rep _eq>> revealing
<<else>>
  Nothing is covering
<</if>>
<<their $g.a>> <<ugenital $g.a>>.
```

</details>

<details>
<summary markdown="span">Add image to quest / event / opportunity / etc</summary>

```
<<questimage "image_name.jpg">>
```

For more information, see
[here](https://gitgud.io/darkofocdarko/fort-of-chains/-/blob/master/docs/images.md#adding-images-to-quests-or-events).

</details>

<details>
<summary markdown="span">Based on if unit has at least X points in some skill</summary>

```
<<if $g.owner.getSkill(setup.skill.combat) >= 40>>
  While <<yourrep $g.owner>> owner|is no slouch in combat,
  <<they $g.owner>> alone won't be sufficient to keep the compound safe.
<<else>>
  This is further compounded by <<yourrep $g.owner>>'s lack of combat ability.
<</if>>
```

List of all skills:

```
setup.skill.combat
setup.skill.brawn
setup.skill.survival
setup.skill.intrigue
setup.skill.slaving
setup.skill.knowledge
setup.skill.social
setup.skill.aid
setup.skill.arcane
setup.skill.sex
```

</details>



<details>
<summary markdown="span">Compare skills between two units (i.e., a skill check)</summary>

```
<<set _res = setup.Skill.skillCheckCompare($g.slaver, $g.enemy, setup.skill.combat)>>
<<if _res == 2>>
  <<Rep $g.slaver>> overwhelmed <<rep $g.enemy>> with <<their $g.slaver>> mighty <<uweapon $g.slaver>>.
<<elseif _res == 1>>
  <<Rep $g.slaver>> manged to scrape a victory over <<rep $g.enemy>>.
<<elseif _res == -1>>
  <<Rep $g.slaver>> slaver|was narrowly defeated by <<rep $g.enemy>>.
<<elseif _res == -2>>
  <<Rep $g.slaver>> slaver|was almost effortlessly defeated by <<rep $g.enemy>>.
<</if>>
```

List of all skills:

```
setup.skill.combat
setup.skill.brawn
setup.skill.survival
setup.skill.intrigue
setup.skill.slaving
setup.skill.knowledge
setup.skill.social
setup.skill.aid
setup.skill.arcane
setup.skill.sex
```

</details>


<details>
<summary markdown="span">Based on if unit is the best friend / lover / best rival of another unit</summary>

```
<<if $g.merc1.getLover() == $g.merc2>>

  <<Rep $g.merc1>> merc1|love going on the same quest with <<their $g.merc1>> lover <<rep $g.merc2>>.

<<elseif $g.merc1.getBestFriend() == $g.merc2>>

  <<Rep $g.merc1>> is going on the same quest with <<utheirrel $g.merc1 $g.merc2>> <<rep $g.merc2>>.

  <<if $friendship.getFriendship($g.merc1, $g.merc2) >= 500>>
    They are good friends.
  <<elseif $friendship.getFriendship($g.merc1, $g.merc2) <= -500>>
    They are rivals.
  <<else>>
    They are still acquintances.
  <</if>>

<</if>>
```

</details>


<details>
<summary markdown="span">Inline choice</summary>

Use inline choice for minor choices you can make, e.g., during events.
For major choices, use mail / opportunities.

```
What would you like to eat?

<<choose>>

<<opt "Banana">>

You eat a banana. It was long and delicious.

<<opt "Apple">>

You eat an apple. It was good.

<<optif $company.player.getMoney() > 5000>>
<<opt "Melon">>

You eat a melon. It is only available for the richer companies.

<</choose>>
```

</details>

<details>
<summary markdown="span">Getting a random, non-actor unit satisfying something</summary>

```
<<set _u = setup.getUnit({
  job: 'slaver',
  available: true,
  notyou: true,
  anytraits: ['muscle_strong', 'muscle_verystrong', 'tough_tough'],
})>>

<<if _u>>
  <<Rep _u>> is quite tough and available, ready for the task.
<<else>>
  <<missingunitquest>>
<</if>>
```

List of all possible options:

```
<<set _u = setup.getUnit({

  // only pick units of this job. Leaving this empty allow picking NPCs
  job: 'slaver' or 'slave',

  // unit must have this tag
  tag: 'unittagname',

  // unit must have this title
  title: 'title_key',

  // unit must be available to go on some quest. Can be on duty
  available: true,

  // unit is chosen at random from all possible options
  random: true,

  // unit must have ALL of these traits.
  alltraits: ['per_cruel', 'per_evil', ],

  // unit must have ANY of these traits. 
  anytraits: ['muscle_verystrong', 'muscle_extremelystrong', 'tough_tough', ],

  // unit cannot be the player character
  notyou: true,

  // unit must be injured
  injured: true,

  // unit must be of this duty:
  duty: 'rescuer',

  // will return the unit with the maximum skill at:
  skill_max: setup.skill.arcane,
})>>
```

</details>
